"use script";var Photo=Backbone.Model.extend({idAttribute:"_id",defaults:{title:"",caption:"",author:""}}),PhotoCollection=Backbone.Collection.extend({model:Photo,url:"http://tiny-pizza-server.herokuapp.com/collections/tad-thumbnails"}),ThumbnailView=Backbone.View.extend({className:"thumbnail",template:_.template($(".thumbnail-template").text()),events:{click:"showDetailView"},initialize:function(){$(".thumbnail-container").append(this.el),this.render()},render:function(){var a=this.template(this.model.attributes);this.$el.html(a)},showDetailView:function(){detailInstance.remove(),detailInstance=new DetailView({model:this.model})}}),DetailView=Backbone.View.extend({className:"detail-view",template:_.template($(".detail-view-template").text()),events:{"click .update-button":"updateModel","click .post-button":"createPhoto","click .clear-button":"clearFields"},initialize:function(){this.listenTo(photos,"add",function(a){new ThumbnailView({model:a})}),this.listenTo(this.model,"change",this.render),$(".left-container").append(this.el),this.render()},render:function(){var a=this.template(this.model.attributes);return this.$el.html(a),this},updateModel:function(){var a=this;this.model.set({url:this.$el.find(".url-input").val(),author:this.$el.find(".author-input").val(),title:this.$el.find(".title-input").val(),caption:this.$el.find(".caption-input").val()}),photos.add(this.model),this.model.save().done(function(){a.$el.find(".clear-button").html("Saved!")})},clearFields:function(){var a=new Photo;this.model=a,this.$el.find("input").val(""),this.$el.find("img").attr("src"," http://placehold.it/700X350")},createPhoto:function(){var a=this;this.model.set({url:this.$el.find(".url-input-add").val(),author:this.$el.find(".author-input-add").val(),title:this.$el.find(".title-input-add").val(),caption:this.$el.find(".caption-input-add").val()}),photos.add(this.model),this.model.save().done(function(){a.$el.find(".post-button-add").html("Saved!")})}}),photos=new PhotoCollection;photos.fetch().done(function(){photos.each(function(a){thumbnailInstance=new ThumbnailView({model:a})}),detailInstance=new DetailView({model:photos.last()})});